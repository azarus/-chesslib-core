{"version":3,"sources":["../../source/Chess/Pieces/Pawn.ts"],"names":[],"mappings":"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","file":"Pawn.js","sourcesContent":["import { Piece, COLORS } from \"../Piece\";\r\nimport { ChessPromoteEvent } from \"../Events\";\r\n\r\nexport class PawnPiece extends Piece\r\n{\r\n\tname = \"Pawn\";\r\n\ttype = \"P\";\r\n\r\n\tenpassant = false;\r\n\r\n\tmove(square)\r\n\t{\r\n\t\tvar current = this.square;\r\n\t\t\r\n\t\t// Set enpassant flag if it was a big move\r\n\t\tif(Math.abs(current.getPosition().y - square.getPosition().y) > 1)\r\n\t\t{\r\n\t\t\tthis.enpassant = true;\r\n\t\t}else{\r\n\t\t\tthis.enpassant = false;\r\n\t\t}\r\n\r\n\t\tif(!super.move(square))\r\n\t\t\treturn false;\r\n\t\t\r\n\r\n\t\t// Check if the move was enpassant capture\r\n\t\tvar back = this.square.getSibling(0, (this.color == COLORS.WHITE ? 1 : -1));\r\n\t\tif(back && back.piece && back.piece.color != this.color && back.piece.enpassant)\r\n\t\t{\r\n\t\t\tthis.capture(back);\r\n\t\t}\r\n\t\t\r\n\t\t// Queening\r\n\t\tvar forwardSquare = this.square.getSibling(0, (this.color == COLORS.WHITE ? -1 : 1));\r\n\t\tif(!forwardSquare)\r\n\t\t{\r\n\t\t\tvar newPiece = this.board.createPiece(\"Q\", this.color);\r\n\t\t\tnewPiece.setSquare(this.square);\r\n\t\t\tnewPiece.lastMoved = Date.now();\r\n\t\t\tthis.board.onPromote.emit(new ChessPromoteEvent(this.square, newPiece,  this.board.SquareToFEN(this.square)));\r\n\t\t}\r\n\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\r\n\tonMoved(square)\r\n\t{\r\n\t\tthis.board.addToHistory(\"move\", {\r\n\t\t\tlastMoved: this.lastMoved,\r\n\t\t\tmoves: this.moves,\r\n\t\t\tenpassant: this.enpassant,\r\n\t\t\tpiece: this,\r\n\t\t\tfrom: this.square,\r\n\t\t\tto: square\r\n\t\t});\r\n\t}\r\n\r\n\tundoMove(move)\r\n\t{\r\n\t\tthis.enpassant = move.enpassant;\r\n\t\tthis.lastMoved = move.lastMoved;\r\n\t\tthis.moves = move.moves;\r\n\t\tthis.setSquare(move.from);\r\n\t}\r\n\r\n\tAfterPieceMoved(piece, square)\r\n\t{\r\n\t\t// If any piece is moved no enpassant moves are allowed\r\n\t\t// if(piece.color != this.color)\r\n\t\t// {\r\n\t\t// \tthis.enpassant = false;\r\n\t\t// }\r\n\r\n\t\t\r\n\t}\r\n\r\n\tgetMoves()\r\n\t{\r\n\t\tvar moves = [];\r\n\t\tvar direction = (this.color == COLORS.WHITE ? -1 : 1);\r\n\t\t\r\n\t\t// 1 Forward\r\n\t\tvar square1 = this.square.getSibling(0, direction);\r\n\t\tif (square1 && !square1.piece)\r\n\t\t{\r\n\t\t\tmoves.push(square1);\r\n\t\t}\r\n\r\n\t\t// 2 Forward (if didn't move yet)\r\n\t\tvar square2 = this.square.getSibling(0, direction * 2);\r\n\t\tif (square2 && !square2.piece && this.moves == 0 && !square1.piece) \r\n\t\t{\r\n\t\t\tmoves.push(square2);\r\n\t\t}\r\n\r\n\t\t// Capture 1\r\n\t\tvar capture1 = this.square.getSibling(1, direction);\r\n\t\tif (capture1 && capture1.piece && capture1.piece.color != this.color)\r\n\t\t{\r\n\t\t\tmoves.push(capture1);\r\n\t\t}\r\n\r\n\t\t// Capture 2\r\n\t\tvar capture2 = this.square.getSibling(-1, direction);\r\n\t\tif (capture2 && capture2.piece && capture2.piece.color != this.color)\r\n\t\t{\r\n\t\t\tmoves.push(capture2);\r\n\t\t}\r\n\t\t\r\n\t\t// En passant capture 1\r\n\t\tvar enpassant1 = this.square.getSibling(1, 0);\r\n\t\tif(enpassant1 && enpassant1.piece && enpassant1.piece.color != this.color && enpassant1.piece.moves == 1 && enpassant1.piece.enpassant)\r\n\t\t{\r\n\t\t\tmoves.push(this.square.getSibling(1, direction));\r\n\t\t}\r\n\r\n\t\t/// En passant capture 2\r\n\t\tvar enpassant2 = this.square.getSibling(-1, 0);\r\n\t\tif(enpassant2 && enpassant2.piece && enpassant2.piece.color != this.color && enpassant2.piece.moves == 1 && enpassant2.piece.enpassant)\r\n\t\t{\r\n\t\t\tmoves.push(this.square.getSibling(-1, direction));\r\n\t\t}\r\n\r\n\t\treturn moves;\r\n\t}\r\n\r\n\r\n};"]}